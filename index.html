<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Sprinklr CCaaS Widget Test</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h2>Sprinklr CCaaS Widget Test</h2>
  <p id="status">Loading Sprinklr SDK...</p>

  <div id="iframe-container" style="width:100%; border:1px solid #ccc; border-radius:6px; overflow:hidden;">
    <iframe id="child-frame" src="https://strikkie-api.github.io/iframeresizetest/content.html"
            width="100%" height="300" style="border:none;"></iframe>
  </div>

  <script>
    const iframe = document.getElementById('child-frame');
    const statusEl = document.getElementById('status');
    const parentOrigin = "https://strikkie-api.github.io"; // must match iframe

    // Listen to messages from iframe
    window.addEventListener('message', (event) => {
      if (event.origin !== parentOrigin) return;

      const data = event.data;
      console.log("Parent received:", data);

      if (data.type === "iframeReady" && data.height) {
        iframe.style.height = data.height + "px";
        statusEl.textContent = "Iframe ready, height set dynamically";
      }

      if (data.type === "sessionStarted") {
        statusEl.textContent = "Session started in iframe";
      }

      if (data.type === "sessionEnded") {
        statusEl.textContent = "Session ended in iframe";
      }
    });
  </script>
</body>
</html>
